#p: ╭──────────── Block Start ────────────╮
#p: ╰───────────── Block End ─────────────╯

# for repeatiting chord keys commands
bind-key s switch-client -T prefix_s
# Exit prefix_s mode with q or Escape (or any key you like)
bind-key -T prefix_s q switch-client -T root
bind-key -T prefix_s Escape switch-client -T root

bind-key -r -T prefix_w f last-window

# choose session
bind-key -T prefix_s s choose-session
# rename  session
bind-key -T prefix_s r command-prompt -p "Rename session to:" "rename-session '%%'"
# bind-key -T prefix_s k kill-session
bind-key -T prefix_s k run-shell "/home/sj/.config/tmux/sessionWindowPane/script/tmux-kill-session-safe.sh"

#prefix b to switch the session cfg
# bind b switch-client -t cfg


#  switch cfg session if not exist then create with 1 windows 3 panes with layout needed then switch to it
# bind b run-shell "
# SESSION=cfg1
# tmux has-session -t \$SESSION 2>/dev/null
# if [ \$? != 0 ]; then
#   tmux new-session -d -s \$SESSION -n 1
#   tmux split-window -t \$SESSION:1.1 -v
#   tmux split-window -t \$SESSION:1.2 -v
#   tmux send-keys -t \$SESSION:1.1 \"zsh -i -c 'tr'\" C-m
#   tmux select-pane -t \$SESSION:1.1
# fi
# tmux switch-client -t \$SESSION
# "


#p: ╭──────────── Block Start ────────────╮
#  switch cfg session, if not exist then create with 3 windows with 3 panes with layout needed then switch to it
bind-key -r -T prefix_s  c run-shell "
 SESSION=cfg
 tmux has-session -t \$SESSION 2>/dev/null
 if [ \$? != 0 ]; then
   tmux new-session -d -s \$SESSION -n 1
   tmux split-window -t \$SESSION:1.1 -v
   tmux split-window -t \$SESSION:1.2 -v
   # Delay to let shell initialize before sending keys
   sleep 0.2
   tmux send-keys -t \$SESSION:1.1 \"zsh -i -c 'tr'\" C-m

   tmux new-window -t \$SESSION:2 -n 2
   tmux split-window -t \$SESSION:2.1 -v
   tmux split-window -t \$SESSION:2.2 -v
   sleep 0.2
   tmux send-keys -t \$SESSION:2.1 \"zsh -i -c 'tr'\" C-m

   tmux new-window -t \$SESSION:3 -n 3
   tmux split-window -t \$SESSION:3.1 -v
   tmux split-window -t \$SESSION:3.2 -v
   sleep 0.2
   tmux send-keys -t \$SESSION:3.1 \"zsh -i -c 'tr'\" C-m

   tmux select-pane -t \$SESSION:1.1
   tmux select-window -t \$SESSION:1
 fi
 tmux switch-client -t \$SESSION
 "
 #p: ╰───────────── Block End ─────────────╯



#p: ╭──────────── Block Start ────────────╮
# create new session with 1 window and 3 panes with tr zsh command for custom layout
bind-key -T prefix_s n command-prompt -p "New session name:" "run-shell 'SESSION=%%; \
tmux new-session -d -s \"\$SESSION\" -n 1; \
tmux split-window -t \"\$SESSION\":1.1 -v; \
tmux split-window -t \"\$SESSION\":1.2 -v; \
tmux send-keys -t \"\$SESSION\":1.1 \"zsh -i -c 'tr'\" C-m; \
tmux select-pane -t \"\$SESSION\":1.1; \
tmux switch-client -t \"\$SESSION\"'"
#p: ╰───────────── Block End ─────────────╯


#p: ╭──────────── Block Start ────────────╮
#  switch surfingKeys session, if not exist then create with 3 windows with 3 panes with layout needed then switch to it
bind-key -r -T prefix_s  b run-shell "
 SESSION=surfingKeys
 tmux has-session -t \$SESSION 2>/dev/null
 if [ \$? != 0 ]; then
   tmux new-session -d -s \$SESSION -n 1
   tmux split-window -t \$SESSION:1.1 -v
   tmux split-window -t \$SESSION:1.2 -v
   # Delay to let shell initialize before sending keys
   sleep 0.2
   tmux send-keys -t \$SESSION:1.1 \"zsh -i -c 'tr'\" C-m

   tmux new-window -t \$SESSION:2 -n 2
   tmux split-window -t \$SESSION:2.1 -v
   tmux split-window -t \$SESSION:2.2 -v
   sleep 0.2
   tmux send-keys -t \$SESSION:2.1 \"zsh -i -c 'tr'\" C-m

   tmux new-window -t \$SESSION:3 -n 3
   tmux split-window -t \$SESSION:3.1 -v
   tmux split-window -t \$SESSION:3.2 -v
   sleep 0.2
   tmux send-keys -t \$SESSION:3.1 \"zsh -i -c 'tr'\" C-m

   tmux select-pane -t \$SESSION:1.1
   tmux select-window -t \$SESSION:1
 fi
 tmux switch-client -t \$SESSION
 "
 #p: ╰───────────── Block End ─────────────╯




# switch to third used session
bind-key -r -T prefix_s t  run-shell "/home/sj/.config/tmux/sessionWindowPane/script/tmux-switch-third.sh"
